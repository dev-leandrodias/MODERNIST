{"cells":[{"cell_type":"markdown","metadata":{"id":"EKOTlwcmxmej"},"source":["# Selecionando sentenças dos originais\n","\n","Realiza a seleção de sentenças que possuem as palavras chaves os arquivos:\n","\n","- `original.zip`\n","- `originalpos.zip`\n","\n","Gera o arquivo:\n","\n","- `original_filtrado.zip`"]},{"cell_type":"markdown","metadata":{"id":"OP33KWAtBMWs"},"source":["# 1 Preparação do ambiente\n","\n","Preparação do ambiente para execução do script."]},{"cell_type":"markdown","metadata":{"id":"PKUr9Vk4BNLC"},"source":["## 1.1 Tempo inicial de processamento"]},{"cell_type":"code","execution_count":1,"metadata":{"executionInfo":{"elapsed":12,"status":"ok","timestamp":1670120938907,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"},"user_tz":180},"id":"JXclHCRQBSF2"},"outputs":[],"source":["# Import das bibliotecas.\n","import time\n","import datetime\n","\n","# Marca o tempo de início do processamento\n","inicio_processamento = time.time()"]},{"cell_type":"markdown","metadata":{"id":"GOcN8hK-scnt"},"source":["## 1.2 Funções e classes auxiliares"]},{"cell_type":"markdown","metadata":{"id":"OPRnA-mk5-c4"},"source":["Verifica se existe o diretório cohebert no diretório corrente.   \n"]},{"cell_type":"code","execution_count":2,"metadata":{"executionInfo":{"elapsed":11,"status":"ok","timestamp":1670120938909,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"},"user_tz":180},"id":"Fj5TaAH_5-nB"},"outputs":[],"source":["# Import das bibliotecas.\n","import os # Biblioteca para manipular arquivos\n","\n","# ============================  \n","def verificaDiretorioCoheBERT():\n","    \"\"\"\n","      Verifica se existe o diretório cohebert no diretório corrente.    \n","    \"\"\"\n","    \n","    # Verifica se o diretório existe\n","    if not os.path.exists(DIRETORIO_COHEBERT):  \n","        # Cria o diretório\n","        os.makedirs(DIRETORIO_COHEBERT)\n","        logging.info(\"Diretório Cohebert criado: {}\".format(DIRETORIO_COHEBERT))\n","    \n","    return DIRETORIO_COHEBERT"]},{"cell_type":"markdown","metadata":{"id":"yDCOeh2y5jOH"},"source":["Realiza o download e um arquivo"]},{"cell_type":"code","execution_count":3,"metadata":{"executionInfo":{"elapsed":11,"status":"ok","timestamp":1670120938910,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"},"user_tz":180},"id":"5B1mvfAU5jZf"},"outputs":[],"source":["# Import das bibliotecas.\n","import requests # Biblioteca de download\n","from tqdm.notebook import tqdm as tqdm_notebook # Biblioteca para barra de progresso\n","import os # Biblioteca para manipular arquivos\n","\n","def downloadArquivo(url_arquivo, nome_arquivo_destino):\n","    \"\"\"    \n","      Realiza o download de um arquivo de uma url em salva em nome_arquivo_destino.\n","    \n","      Parâmetros:\n","        `url_arquivo` - URL do arquivo a ser feito download.      \n","        `nome_arquivo_destino` - Nome do arquivo a ser salvo.      \n","    \"\"\"\n","    \n","    # Verifica se existe o diretório base\n","    DIRETORIO_COHEBERT = verificaDiretorioCoheBERT()\n","    \n","    # Realiza o download de um arquivo em uma url\n","    data = requests.get(url_arquivo, stream=True)\n","    \n","    # Verifica se o arquivo existe\n","    if data.status_code != 200:\n","        logging.info(\"Exceção ao tentar realizar download {}. Response {}.\".format(url_arquivo, data.status_code))\n","        data.raise_for_status()\n","        return\n","\n","    # Recupera o nome do arquivo a ser realizado o download    \n","    nome_arquivo = nome_arquivo_destino.split(\"/\")[-1]  \n","\n","    # Define o nome e caminho do arquivo temporário    \n","    nome_arquivo_temporario = DIRETORIO_COHEBERT + \"/\" + nome_arquivo + \"_part\"\n","    \n","    logging.info(\"Download do arquivo: {}.\".format(nome_arquivo_destino))\n","    \n","    # Baixa o arquivo\n","    with open(nome_arquivo_temporario, \"wb\") as arquivo_binario:        \n","        tamanho_conteudo = data.headers.get(\"Content-Length\")        \n","        total = int(tamanho_conteudo) if tamanho_conteudo is not None else None\n","        # Barra de progresso de download\n","        progresso_bar = tqdm_notebook(unit=\"B\", total=total, unit_scale=True)                \n","        # Atualiza a barra de progresso\n","        for chunk in data.iter_content(chunk_size=1024):        \n","            if chunk:                \n","                progresso_bar.update(len(chunk))\n","                arquivo_binario.write(chunk)\n","    \n","    # Renomeia o arquivo temporário para o arquivo definitivo\n","    os.rename(nome_arquivo_temporario, nome_arquivo_destino)\n","    \n","    # Fecha a barra de progresso.\n","    progresso_bar.close()"]},{"cell_type":"markdown","metadata":{"id":"ksYnRk7zLGp0"},"source":["Remove tags de um documento"]},{"cell_type":"code","execution_count":4,"metadata":{"executionInfo":{"elapsed":10,"status":"ok","timestamp":1670120938911,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"},"user_tz":180},"id":"6qwKjGvyLG4v"},"outputs":[],"source":["def remove_tags(documento):\n","    \"\"\"\n","      Remove tags de um documento\n","    \"\"\"\n","    \n","    import re\n","\n","    documento_limpo = re.compile(\"<.*?>\")\n","    return re.sub(documento_limpo, \"\", documento)"]},{"cell_type":"markdown","metadata":{"id":"4pduTsINLeaz"},"source":["Funções auxiliares de arquivos"]},{"cell_type":"code","execution_count":5,"metadata":{"executionInfo":{"elapsed":7,"status":"ok","timestamp":1670120939201,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"},"user_tz":180},"id":"jirIzIstLea0"},"outputs":[],"source":["def carregar(nome_arquivo, encoding=\"Windows-1252\"):\n","    \"\"\"\n","      Carrega um arquivo texto e retorna as linhas como um único parágrafo(texto).\n","    \n","      Parâmetros:\n","        `nome_arquivo` - Nome do arquivo a ser carregado.  \n","    \"\"\"\n","\n","    # Abre o arquivo\n","    arquivo = open(nome_arquivo, \"r\", encoding= encoding)\n","    \n","    paragrafo = \"\"\n","    for linha in arquivo:\n","        linha = linha.splitlines()\n","        linha = \" \".join(linha)\n","        # Remove as tags existentes no final das linhas\n","        linha = remove_tags(linha)\n","        if linha != \"\":\n","          paragrafo = paragrafo + linha.strip() + \" \"\n","    \n","    # Fecha o arquivo\n","    arquivo.close()\n","\n","    # Remove os espaços em branco antes e depois do parágrafo\n","    return paragrafo.strip()"]},{"cell_type":"code","execution_count":6,"metadata":{"executionInfo":{"elapsed":6,"status":"ok","timestamp":1670120939201,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"},"user_tz":180},"id":"EC9Xppq-_R0w"},"outputs":[],"source":["def carregarLista(nome_arquivo, encoding=\"Windows-1252\"):\n","    \"\"\"\n","      Carrega um arquivo texto e retorna as linhas como uma lista de sentenças(texto).\n","    \n","      Parâmetros:\n","        `nome_arquivo` - Nome do arquivo a ser carregado.   \n","        `encoding` - Codificação dos caracteres do arquivo.\n","    \"\"\"\n","\n","    # Abre o arquivo\n","    arquivo = open(nome_arquivo, \"r\", encoding= encoding)\n","    \n","    sentencas = []\n","    for linha in arquivo:        \n","        linha = linha.splitlines()\n","        linha = \" \".join(linha)\n","        linha = remove_tags(linha)\n","        if linha != \"\":\n","          sentencas.append(linha.strip())\n","    \n","    # Fecha o arquivo\n","    arquivo.close()\n","\n","    return sentencas "]},{"cell_type":"code","execution_count":7,"metadata":{"executionInfo":{"elapsed":6,"status":"ok","timestamp":1670120939202,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"},"user_tz":180},"id":"fkVk5LQT_G3f"},"outputs":[],"source":["def salvar(nome_arquivo,texto):                       \n","    \"\"\"\n","      Salva um texto em arquivo.\n","     \n","      Parâmetros:\n","        `nome_arquivo` - Nome do arquivo a ser salvo.\n","        `texto` - Texto a ser salvo.     \n","    \"\"\"\n","\n","    arquivo = open(nome_arquivo, \"w\")\n","    arquivo.write(str(texto))\n","    arquivo.close()"]},{"cell_type":"markdown","metadata":{"id":"603LYIYKBmq5"},"source":["Função auxiliar para formatar o tempo como `hh: mm: ss`"]},{"cell_type":"code","execution_count":8,"metadata":{"executionInfo":{"elapsed":6,"status":"ok","timestamp":1670120939202,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"},"user_tz":180},"id":"Guy6B4whsZFR"},"outputs":[],"source":["# Import das bibliotecas.\n","import time\n","import datetime\n","\n","def formataTempo(tempo):\n","    \"\"\"\n","      Pega a tempo em segundos e retorna uma string hh:mm:ss\n","    \"\"\"\n","    # Arredonda para o segundo mais próximo.\n","    tempo_arredondado = int(round((tempo)))\n","    \n","    # Formata como hh:mm:ss\n","    return str(datetime.timedelta(seconds=tempo_arredondado))    "]},{"cell_type":"markdown","metadata":{"id":"zVKAapz7RCxk"},"source":["Classe(ModelArguments) de definição dos parâmetros do modelo"]},{"cell_type":"code","execution_count":9,"metadata":{"executionInfo":{"elapsed":6,"status":"ok","timestamp":1670120939202,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"},"user_tz":180},"id":"zgmN6RqDRDZS"},"outputs":[],"source":["# Import das bibliotecas.\n","from dataclasses import dataclass, field\n","from typing import Dict, Optional\n","from typing import List\n","\n","@dataclass\n","class ModeloArgumentosMedida:\n","    max_seq_len: Optional[int] = field(\n","        default=None,\n","        metadata={\"help\": \"max seq len\"},\n","    )    \n","    pretrained_model_name_or_path: str = field(\n","        default=\"neuralmind/bert-base-portuguese-cased\",\n","        metadata={\"help\": \"nome do modelo pré-treinado do BERT.\"},\n","    )\n","    modelo_spacy: str = field(\n","        default=\"pt_core_news_lg\",\n","        metadata={\"help\": \"nome do modelo do spaCy.\"},\n","    )\n","    versao_modelo_spacy: str = field(\n","        default=\"-3.2.0\",\n","        metadata={\"help\": \"versão do nome do modelo no spaCy.\"},\n","    )\n","    sentenciar_documento: bool = field(\n","        default=True,\n","        metadata={\"help\": \"Dividir o documento em sentenças(frases).\"},\n","    )\n","    do_lower_case: bool = field(\n","        default=False,\n","        metadata={\"help\": \"define se o texto do modelo deve ser todo em minúsculo.\"},\n","    )    \n","    output_attentions: bool = field(\n","        default=False,\n","        metadata={\"help\": \"habilita se o modelo retorna os pesos de atenção.\"},\n","    )\n","    output_hidden_states: bool = field(\n","        default=False,\n","        metadata={\"help\": \"habilita gerar as camadas ocultas do modelo.\"},\n","    )\n","    usar_mcl_ajustado : bool = field(\n","        default=False,\n","        metadata={\"help\": \"habilita o carragamento de mcl ajustado.\"},\n","    )"]},{"cell_type":"markdown","metadata":{"id":"rceIwWa7UmFZ"},"source":["Biblioteca de limpeza de tela\n"]},{"cell_type":"code","execution_count":10,"metadata":{"executionInfo":{"elapsed":6,"status":"ok","timestamp":1670120939203,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"},"user_tz":180},"id":"PXTEvmuhUmjO"},"outputs":[],"source":["# Import das bibliotecas.\n","from IPython.display import clear_output"]},{"cell_type":"markdown","metadata":{"id":"iAPVtRXQqDim"},"source":["## 1.3 Tratamento de logs"]},{"cell_type":"code","execution_count":11,"metadata":{"executionInfo":{"elapsed":6,"status":"ok","timestamp":1670120939203,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"},"user_tz":180},"id":"DcopxbGZqDip"},"outputs":[],"source":["# Import das bibliotecas.\n","import logging # Biblioteca de logging\n","\n","# Formatando a mensagem de logging\n","logging.basicConfig(format=\"%(asctime)s : %(levelname)s : %(message)s\")\n","\n","logger = logging.getLogger()\n","logger.setLevel(logging.INFO)"]},{"cell_type":"markdown","metadata":{"id":"_GjYtXcMnSAe"},"source":["## 1.4 Identificando o ambiente Colab"]},{"cell_type":"code","execution_count":12,"metadata":{"executionInfo":{"elapsed":7,"status":"ok","timestamp":1670120939204,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"},"user_tz":180},"id":"YMiH0E3OnRa1"},"outputs":[],"source":["# Import das bibliotecas.\n","import sys # Biblioteca para acessar módulos do sistema\n","\n","# Se estiver executando no Google Colaboratory\n","# Retorna true ou false se estiver no Google Colaboratory\n","IN_COLAB = \"google.colab\" in sys.modules"]},{"cell_type":"markdown","metadata":{"id":"RinFHFesVKis"},"source":["## 1.5 Colaboratory"]},{"cell_type":"markdown","metadata":{"id":"MPngEboiVbfi"},"source":["Usando Colab GPU para Treinamento\n"]},{"cell_type":"markdown","metadata":{"id":"EjWE6WlvVbfj"},"source":["Uma GPU pode ser adicionada acessando o menu e selecionando:\n","\n","`Edit -> Notebook Settings -> Hardware accelerator -> (GPU)`\n","\n","Em seguida, execute a célula a seguir para confirmar que a GPU foi detectada."]},{"cell_type":"code","execution_count":13,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":5851,"status":"ok","timestamp":1670120945049,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"},"user_tz":180},"id":"vtaYZmc3Vbfj","outputId":"fb08c15c-6c30-4e9b-e93e-3fcd45979ab6"},"outputs":[{"output_type":"stream","name":"stderr","text":["INFO:numexpr.utils:NumExpr defaulting to 2 threads.\n","INFO:root:Dispositivo GPU não encontrado\n"]}],"source":["# Import das bibliotecas.\n","import tensorflow as tf\n","\n","# Recupera o nome do dispositido da GPU.\n","device_name = tf.test.gpu_device_name()\n","\n","# O nome do dispositivo deve ser parecido com o seguinte:\n","if device_name == \"/device:GPU:0\":\n","    logging.info(\"Encontrei GPU em: {}\".format(device_name))\n","else:\n","    logging.info(\"Dispositivo GPU não encontrado\")\n","    #raise SystemError(\"Dispositivo GPU não encontrado\")"]},{"cell_type":"markdown","metadata":{"id":"iYRrUo2XWa8G"},"source":["Nome da GPU\n","\n","Para que a torch use a GPU, precisamos identificar e especificar a GPU como o dispositivo. Posteriormente, em nosso ciclo de treinamento, carregaremos dados no dispositivo.\n","\n","Vale a pena observar qual GPU você recebeu. A GPU Tesla P100 é muito mais rápido que as outras GPUs, abaixo uma lista ordenada:\n","- 1o Tesla P100\n","- 2o Tesla T4\n","- 3o Tesla P4 (Não tem memória para execução 4 x 8, somente 2 x 4)\n","- 4o Tesla K80 (Não tem memória para execução 4 x 8, somente 2 x 4)"]},{"cell_type":"code","execution_count":14,"metadata":{"executionInfo":{"elapsed":5145,"status":"ok","timestamp":1670120950188,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"},"user_tz":180},"id":"zrjqDO6nWa8J"},"outputs":[],"source":["# Import das bibliotecas.\n","import torch # Biblioteca para manipular os tensores\n","\n","def getDeviceGPU():\n","    \"\"\"\n","    Retorna um dispositivo de GPU se disponível ou CPU.\n","    \n","    Retorno:\n","    `device` - Um device de GPU ou CPU.       \n","    \"\"\"\n","        \n","    # Se existe GPU disponível.\n","    if torch.cuda.is_available():\n","        \n","        # Diz ao PyTorch para usar GPU.    \n","        device = torch.device(\"cuda\")\n","        \n","        logging.info(\"Existem {} GPU(s) disponíveis.\".format(torch.cuda.device_count()))\n","        logging.info(\"Iremos usar a GPU: {}.\".format(torch.cuda.get_device_name(0)))\n","\n","    # Se não.\n","    else:        \n","        logging.info(\"Sem GPU disponível, usando CPU.\")\n","        device = torch.device(\"cpu\")\n","        \n","    return device"]},{"cell_type":"code","execution_count":15,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":20,"status":"ok","timestamp":1670120950189,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"},"user_tz":180},"id":"ChDxmtXsKwjf","outputId":"e4d3ca11-dabb-4ac7-a762-aef002edc20b"},"outputs":[{"output_type":"stream","name":"stderr","text":["INFO:root:Sem GPU disponível, usando CPU.\n"]}],"source":["device = getDeviceGPU()"]},{"cell_type":"markdown","metadata":{"id":"kkdlEouHftcJ"},"source":["Conecta o modelo ao device"]},{"cell_type":"code","execution_count":16,"metadata":{"executionInfo":{"elapsed":16,"status":"ok","timestamp":1670120950190,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"},"user_tz":180},"id":"a-znVDGyfsVx"},"outputs":[],"source":["# Import das bibliotecas.\n","import torch # Biblioteca para manipular os tensores\n","\n","def conectaGPU(model, device):\n","    \"\"\"\n","      Conecta um modelo BERT a GPU.\n","\n","      Parâmetros:\n","        `model` - Um modelo BERT carregado.       \n","        `device` - Um device de GPU.     \n","    \n","      Retorno:\n","        `model` - Um objeto model BERT conectado a GPU.     \n","    \"\"\"\n","    # Associa a GPU ao modelo.\n","    model.to(device)\n","\n","    # Se existe GPU disponível.\n","    if torch.cuda.is_available():    \n","        # Diga ao pytorch para rodar este modelo na GPU.\n","        logging.info(\"Pytorch rodando o modelo na GPU.\")\n","        model.cuda()\n","        \n","    else:\n","        logging.info(\"Pytorch rodando sem GPU.\")\n","\n","    return model"]},{"cell_type":"markdown","metadata":{"id":"fGf59D0yVNx9"},"source":["Memória\n","\n","Memória disponível no ambiente"]},{"cell_type":"code","execution_count":17,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":16,"status":"ok","timestamp":1670120950191,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"},"user_tz":180},"id":"1iC5-pSAVh7_","outputId":"4dd64f1c-6b66-4352-e330-874aea48ded2"},"outputs":[{"output_type":"stream","name":"stderr","text":["INFO:root:Seu ambiente de execução tem  13.6 gigabytes de RAM disponível\n","\n","INFO:root:Para habilitar um tempo de execução de RAM alta, selecione menu o ambiente de execução> \"Alterar tipo de tempo de execução\"\n","INFO:root:e selecione High-RAM. Então, execute novamente está célula\n"]}],"source":["# Importando as bibliotecas.\n","from psutil import virtual_memory\n","\n","ram_gb = virtual_memory().total / 1e9\n","logging.info(\"Seu ambiente de execução tem {: .1f} gigabytes de RAM disponível\\n\".format(ram_gb))\n","\n","if ram_gb < 20:\n","  logging.info(\"Para habilitar um tempo de execução de RAM alta, selecione menu o ambiente de execução> \\\"Alterar tipo de tempo de execução\\\"\")\n","  logging.info(\"e selecione High-RAM. Então, execute novamente está célula\")\n","else:\n","  logging.info(\"Você está usando um ambiente de execução de memória RAM alta!\")"]},{"cell_type":"markdown","metadata":{"id":"wijMXooQQLcQ"},"source":["## 1.6 Monta uma pasta no google drive para carregar os arquivos de dados."]},{"cell_type":"code","execution_count":18,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":28200,"status":"ok","timestamp":1670120978381,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"},"user_tz":180},"id":"ysnDDapMQK8K","outputId":"cff8899b-c5e9-448f-ae07-39f9efe507ed"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["#@title\n","# import necessário\n","from google.colab import drive\n","\n","# Monta o drive na pasta especificada\n","drive.mount(\"/content/drive\")     "]},{"cell_type":"markdown","metadata":{"id":"Pqa-7WXBAw8q"},"source":["## 1.9 Instalação do BERT da Hugging Face"]},{"cell_type":"markdown","metadata":{"id":"eCdqJCtQN52l"},"source":["Instala a interface pytorch para o BERT by Hugging Face. "]},{"cell_type":"code","execution_count":19,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":9040,"status":"ok","timestamp":1670120987418,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"},"user_tz":180},"id":"1RfUN_KolV-f","outputId":"1a942449-0b70-40be-8eae-88f0997e7550"},"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting transformers==4.5.1\n","  Downloading transformers-4.5.1-py3-none-any.whl (2.1 MB)\n","\u001b[K     |████████████████████████████████| 2.1 MB 7.6 MB/s \n","\u001b[?25hRequirement already satisfied: packaging in /usr/local/lib/python3.8/dist-packages (from transformers==4.5.1) (21.3)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.8/dist-packages (from transformers==4.5.1) (2022.6.2)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.8/dist-packages (from transformers==4.5.1) (3.8.0)\n","Collecting sacremoses\n","  Downloading sacremoses-0.0.53.tar.gz (880 kB)\n","\u001b[K     |████████████████████████████████| 880 kB 75.6 MB/s \n","\u001b[?25hRequirement already satisfied: requests in /usr/local/lib/python3.8/dist-packages (from transformers==4.5.1) (2.23.0)\n","Requirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.8/dist-packages (from transformers==4.5.1) (4.64.1)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.8/dist-packages (from transformers==4.5.1) (1.21.6)\n","Collecting tokenizers<0.11,>=0.10.1\n","  Downloading tokenizers-0.10.3-cp38-cp38-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl (3.3 MB)\n","\u001b[K     |████████████████████████████████| 3.3 MB 35.5 MB/s \n","\u001b[?25hRequirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /usr/local/lib/python3.8/dist-packages (from packaging->transformers==4.5.1) (3.0.9)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.8/dist-packages (from requests->transformers==4.5.1) (3.0.4)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.8/dist-packages (from requests->transformers==4.5.1) (2022.9.24)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.8/dist-packages (from requests->transformers==4.5.1) (1.24.3)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.8/dist-packages (from requests->transformers==4.5.1) (2.10)\n","Requirement already satisfied: six in /usr/local/lib/python3.8/dist-packages (from sacremoses->transformers==4.5.1) (1.15.0)\n","Requirement already satisfied: click in /usr/local/lib/python3.8/dist-packages (from sacremoses->transformers==4.5.1) (7.1.2)\n","Requirement already satisfied: joblib in /usr/local/lib/python3.8/dist-packages (from sacremoses->transformers==4.5.1) (1.2.0)\n","Building wheels for collected packages: sacremoses\n","  Building wheel for sacremoses (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for sacremoses: filename=sacremoses-0.0.53-py3-none-any.whl size=895260 sha256=ba1110bc0ce82d925cbf3d8ca1623fd4cd845ae7290dc618c6575bd3c8645db2\n","  Stored in directory: /root/.cache/pip/wheels/82/ab/9b/c15899bf659ba74f623ac776e861cf2eb8608c1825ddec66a4\n","Successfully built sacremoses\n","Installing collected packages: tokenizers, sacremoses, transformers\n","Successfully installed sacremoses-0.0.53 tokenizers-0.10.3 transformers-4.5.1\n"]}],"source":["!pip install -U transformers==4.5.1"]},{"cell_type":"markdown","metadata":{"id":"8bGda5JgMtQe"},"source":["# 2 Parametrização"]},{"cell_type":"markdown","metadata":{"id":"ifrYNTwGwKal"},"source":["## Gerais"]},{"cell_type":"code","execution_count":20,"metadata":{"executionInfo":{"elapsed":12,"status":"ok","timestamp":1670120987419,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"},"user_tz":180},"id":"5uiH9pNpwI6g"},"outputs":[],"source":["# Definição dos parâmetros a serem avaliados\n","\n","#Realiza o pooling dos tokens de palavras fora do vocabulário do BERT\n","POOLING_TOKENS = 1 # 1 - Sem pooling / 1 - Com pooling \n","\n","#Estratégia de recuperação dos embeddings: (1 - Embeddings da última camada, \n","#                                           2 - Embeddings da concatenação das 4 últimas camadas)\n","ESTRATEGIA_EMBEDDING = 1"]},{"cell_type":"markdown","metadata":{"id":"mhByVujAwNAU"},"source":["## Específicos"]},{"cell_type":"markdown","metadata":{"id":"FhMuEM1o1Aq3"},"source":["Parâmetros do modelo"]},{"cell_type":"code","execution_count":21,"metadata":{"executionInfo":{"elapsed":11,"status":"ok","timestamp":1670120987419,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"},"user_tz":180},"id":"oJ15-ylRRRdD"},"outputs":[],"source":["# Definição dos parâmetros do Modelo.\n","model_args = ModeloArgumentosMedida(     \n","    max_seq_len = 512,\n","    #pretrained_model_name_or_path = \"https://neuralmind-ai.s3.us-east-2.amazonaws.com/nlp/bert-large-portuguese-cased/bert-large-portuguese-cased_pytorch_checkpoint.zip\",\n","    #pretrained_model_name_or_path = \"https://neuralmind-ai.s3.us-east-2.amazonaws.com/nlp/bert-base-portuguese-cased/bert-base-portuguese-cased_pytorch_checkpoint.zip\",\n","    pretrained_model_name_or_path = \"neuralmind/bert-large-portuguese-cased\",\n","    #pretrained_model_name_or_path = \"neuralmind/bert-base-portuguese-cased\",    \n","    #pretrained_model_name_or_path = \"bert-base-multilingual-cased\",\n","    #pretrained_model_name_or_path = \"bert-base-multilingual-uncased\",\n","    modelo_spacy = \"pt_core_news_lg\",\n","    #modelo_spacy = \"pt_core_news_md\",\n","    #modelo_spacy = \"pt_core_news_sm\",\n","    versao_modelo_spacy = \"3.2.0\",\n","    sentenciar_documento = True,\n","    do_lower_case = False,   # default True  \n","    output_attentions = False,  # default False\n","    output_hidden_states = True, # default False, se True retorna todas as camadas do modelo para as operações de soma e concatenação\n","    usar_mcl_ajustado = False, # Especifica se deve ser carregado um MCL ajustado ou pré-treinado. Necessário especificar o tipo do modelo em pretrained_model_name_or_path. \n",")"]},{"cell_type":"markdown","metadata":{"id":"BLOqjcIzImVo"},"source":["## Nome do diretório dos arquivos de dados"]},{"cell_type":"code","execution_count":22,"metadata":{"executionInfo":{"elapsed":11,"status":"ok","timestamp":1670120987419,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"},"user_tz":180},"id":"xJEiTPnKImVp"},"outputs":[],"source":["# Diretório do cohebert\n","DIRETORIO_COHEBERT = \"MODERNIST\""]},{"cell_type":"markdown","metadata":{"id":"SUxlx7Sx4yxj"},"source":["## Define o caminho para os arquivos de dados"]},{"cell_type":"code","execution_count":23,"metadata":{"executionInfo":{"elapsed":10,"status":"ok","timestamp":1670120987419,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"},"user_tz":180},"id":"-gQpxAO74yxj"},"outputs":[],"source":["# Diretório local para os arquivos pré-processados\n","DIRETORIO_LOCAL = \"/content/\" + DIRETORIO_COHEBERT + \"/\"\n","\n","# Diretório no google drive com os arquivos pré-processados\n","DIRETORIO_DRIVE = \"/content/drive/MyDrive/Colab Notebooks/Data/\" + DIRETORIO_COHEBERT + \"/\""]},{"cell_type":"markdown","metadata":{"id":"tDgJTbPOZ8SW"},"source":["## Inicialização diretórios"]},{"cell_type":"markdown","metadata":{"id":"qpSERA9TC4WU"},"source":["Diretório base local"]},{"cell_type":"code","execution_count":24,"metadata":{"executionInfo":{"elapsed":11,"status":"ok","timestamp":1670120987420,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"},"user_tz":180},"id":"edg7eW2cDflg"},"outputs":[],"source":["# Importando as bibliotecas.\n","import os\n","\n","def criaDiretorioLocal():\n","\n","  # Cria o diretório para receber os arquivos Originais e Permutados\n","  # Diretório a ser criado\n","  dirbase = DIRETORIO_LOCAL[:-1]\n","\n","  if not os.path.exists(dirbase):  \n","      # Cria o diretório\n","      os.makedirs(dirbase)    \n","      logging.info(\"Diretório criado: {}.\".format(dirbase))\n","  else:    \n","      logging.info(\"Diretório já existe: {}.\".format(dirbase))"]},{"cell_type":"code","execution_count":25,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":11,"status":"ok","timestamp":1670120987420,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"},"user_tz":180},"id":"xge0ar9MJoKy","outputId":"4f599c2d-0b55-448b-fbbb-3d38dbc99f29"},"outputs":[{"output_type":"stream","name":"stderr","text":["INFO:root:Diretório criado: /content/MODERNIST.\n"]}],"source":["criaDiretorioLocal()"]},{"cell_type":"markdown","metadata":{"id":"Y7W-7V3QFbpR"},"source":["\n","# 3 Carrega dados"]},{"cell_type":"markdown","metadata":{"id":"oQUy9Tat2EF_"},"source":["## 3.1 Carregamento dos arquivos de dados originais e permutados"]},{"cell_type":"markdown","metadata":{"id":"bD_tNbBGPrnE"},"source":["### 3.1.1 Especifica os nomes dos arquivos de dados\n","\n"]},{"cell_type":"code","execution_count":26,"metadata":{"executionInfo":{"elapsed":10,"status":"ok","timestamp":1670120987420,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"},"user_tz":180},"id":"bNgwJRC2uGJb"},"outputs":[],"source":["# Nome do arquivo\n","# Nome do arquivo original\n","NOME_ARQUIVO_DOCUMENTO_FILTRADO = \"pares_medidas_entre_sentencas_vitimas_algoz.csv\"\n","# NOME_ARQUIVO_DOCUMENTO_FILTRADO = \"pares_medidas_entre_sentencas.csv\"\n","\n","NOME_ARQUIVO_DOCUMENTO_FILTRADO_COMPACTADO = \"pares_medidas_entre_sentencas_vitimas_algoz.zip\"\n","# NOME_ARQUIVO_DOCUMENTO_FILTRADO_COMPACTADO = \"pares_medidas_entre_sentencas.zip\""]},{"cell_type":"markdown","metadata":{"id":"I0LsmsBlJeeV"},"source":["### 3.1.2 Cria o diretório local para receber os dados"]},{"cell_type":"code","execution_count":27,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":10,"status":"ok","timestamp":1670120987420,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"},"user_tz":180},"id":"gFYIHcIHE985","outputId":"1b3e534d-1d67-42d7-c95b-c9ce56e7ac45"},"outputs":[{"output_type":"stream","name":"stderr","text":["INFO:root:Diretório já existe: /content/MODERNIST\n"]}],"source":["# Importando as bibliotecas.\n","import os\n","\n","# Cria o diretório para receber os arquivos Originais e Permutados\n","# Diretório a ser criado\n","dirbase = DIRETORIO_LOCAL[:-1]\n","\n","if not os.path.exists(dirbase):  \n","    # Cria o diretório\n","    os.makedirs(dirbase)    \n","    logging.info(\"Diretório criado: {}\".format(dirbase))\n","else:    \n","    logging.info(\"Diretório já existe: {}\".format(dirbase))"]},{"cell_type":"markdown","metadata":{"id":"D8A9syejCsD2"},"source":["### 3.1.3 Copia os arquivos do Google Drive para o Colaboratory"]},{"cell_type":"code","execution_count":28,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":3102,"status":"ok","timestamp":1670120990514,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"},"user_tz":180},"id":"pviuxToMCxQw","outputId":"c939c342-9883-4e57-c505-37bbd28e3848"},"outputs":[{"output_type":"stream","name":"stderr","text":["INFO:root:Terminei a cópia.\n"]}],"source":["# Se estiver executando no Google Colaboratory\n","if IN_COLAB:\n","\n","  !cp \"$DIRETORIO_DRIVE$NOME_ARQUIVO_DOCUMENTO_FILTRADO_COMPACTADO\" \"$DIRETORIO_LOCAL\"\n","\n","  logging.info(\"Terminei a cópia.\")"]},{"cell_type":"markdown","metadata":{"id":"rFCvZ6CUmt-9"},"source":["Descompacta os arquivos.\n","\n","Usa o unzip para descompactar:\n","*   `-o` sobrescreve o arquivo se existir\n","*   `-j` Não cria nenhum diretório\n","*   `-q` Desliga as mensagens \n","*   `-d` Diretório de destino\n"]},{"cell_type":"code","execution_count":29,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":28540,"status":"ok","timestamp":1670121019049,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"},"user_tz":180},"id":"dbHl3d88mouc","outputId":"cb51eb6c-b875-4130-9402-13757d06db1f"},"outputs":[{"output_type":"stream","name":"stderr","text":["INFO:root:Terminei a descompactação.\n"]}],"source":["# Se estiver executando no Google Colaboratory\n","if IN_COLAB:\n","  !unzip -o -j -q \"$DIRETORIO_LOCAL$NOME_ARQUIVO_DOCUMENTO_FILTRADO_COMPACTADO\" -d \"$DIRETORIO_LOCAL\"\n","\n","  logging.info(\"Terminei a descompactação.\")"]},{"cell_type":"markdown","metadata":{"id":"qzhYJNWJm1z4"},"source":["### 3.1.4 Carregamento das lista com os dados dos arquivos originais"]},{"cell_type":"markdown","metadata":{"id":"Usr1uRzQeJSb"},"source":["#### Carrega o arquivo dos dados originais e POS"]},{"cell_type":"code","execution_count":30,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":46579,"status":"ok","timestamp":1670121065616,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"},"user_tz":180},"id":"QRHlixdHEDTb","outputId":"3f673582-3ae6-4f43-8e29-dced7c09e406"},"outputs":[{"output_type":"stream","name":"stderr","text":["INFO:root:TERMINADO ORIGINAIS: 3396616.\n"]}],"source":["# Import das bibliotecas.\n","import pandas as pd\n","\n","# Abre o arquivo e retorna o DataFrame\n","lista_documentos_originais_filtrados = pd.read_csv(DIRETORIO_LOCAL + NOME_ARQUIVO_DOCUMENTO_FILTRADO, sep=\";\", encoding=\"UTF-8\")\n","\n","\n","logging.info(\"TERMINADO ORIGINAIS: {}.\".format(len(lista_documentos_originais_filtrados)))\n"]},{"cell_type":"code","execution_count":31,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":0},"executionInfo":{"elapsed":315,"status":"ok","timestamp":1670121065905,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"},"user_tz":180},"id":"jJ5STBZPLlie","outputId":"4bc5925b-e866-4d33-e1cf-381ddf65f37a"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["         sw1_id                                      sw1_documento  \\\n","650243   203997  O sedutor e a escrava abraçados se associavam,...   \n","1379469  203696  Pois minha senhora acredita, que o senhor Fred...   \n","404162   200121  Domingos Caetano e Angélica não destinavam Sim...   \n","1162248  200810  O escravo africano mata o senhor, e se afasta ...   \n","1067624  200776                            “escravo... escravo...”   \n","\n","         sw1_idOcorrencia sw1_palavraAlvo sw1_grupo            sw1_obra  \\\n","650243                 11         escrava   escravo  As Vítimas-Algozes   \n","1379469                 2         senhora    senhor  As Vítimas-Algozes   \n","404162                 73         crioulo   crioulo  As Vítimas-Algozes   \n","1162248                14         escravo   escravo  As Vítimas-Algozes   \n","1067624                 3         escravo   escravo  As Vítimas-Algozes   \n","\n","                        sw1_autor  sw1_ano  sw1_idObra sw1_movimento  ...  \\\n","650243   Joaquim Manuel de Macedo     1869           2    Romantismo  ...   \n","1379469  Joaquim Manuel de Macedo     1869           2    Romantismo  ...   \n","404162   Joaquim Manuel de Macedo     1869           2    Romantismo  ...   \n","1162248  Joaquim Manuel de Macedo     1869           2    Romantismo  ...   \n","1067624  Joaquim Manuel de Macedo     1869           2    Romantismo  ...   \n","\n","                   sw2_obra                 sw2_autor  sw2_ano sw2_idObra  \\\n","650243   As Vítimas-Algozes  Joaquim Manuel de Macedo     1869          2   \n","1379469  As Vítimas-Algozes  Joaquim Manuel de Macedo     1869          2   \n","404162   As Vítimas-Algozes  Joaquim Manuel de Macedo     1869          2   \n","1162248  As Vítimas-Algozes  Joaquim Manuel de Macedo     1869          2   \n","1067624  As Vítimas-Algozes  Joaquim Manuel de Macedo     1869          2   \n","\n","         sw2_movimento                                       sw2_document  \\\n","650243      Romantismo  Simeão , escravo , contando com a liberdade , ...   \n","1379469     Romantismo  Soam os grosseiros instrumentos que lembram as...   \n","404162      Romantismo  No Brasil a gente livre mais rude nega , como ...   \n","1162248     Romantismo  se porém o erro se repete , se o vício ou a co...   \n","1067624     Romantismo                     – Que tolice , minha senhora !   \n","\n","        sw2_length  cos_mean   euc_mean   man_mean  \n","650243          55  0.907368   6.427903  162.41837  \n","1379469         66  0.864472   8.125162  202.32175  \n","404162          24  0.905213   6.944480  165.93378  \n","1162248         56  0.891151   6.813987  171.85657  \n","1067624          7  0.592091  16.336397  399.74260  \n","\n","[5 rows x 27 columns]"],"text/html":["\n","  <div id=\"df-2ebcd70e-f80c-47f1-89ce-4db874880a8d\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>sw1_id</th>\n","      <th>sw1_documento</th>\n","      <th>sw1_idOcorrencia</th>\n","      <th>sw1_palavraAlvo</th>\n","      <th>sw1_grupo</th>\n","      <th>sw1_obra</th>\n","      <th>sw1_autor</th>\n","      <th>sw1_ano</th>\n","      <th>sw1_idObra</th>\n","      <th>sw1_movimento</th>\n","      <th>...</th>\n","      <th>sw2_obra</th>\n","      <th>sw2_autor</th>\n","      <th>sw2_ano</th>\n","      <th>sw2_idObra</th>\n","      <th>sw2_movimento</th>\n","      <th>sw2_document</th>\n","      <th>sw2_length</th>\n","      <th>cos_mean</th>\n","      <th>euc_mean</th>\n","      <th>man_mean</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>650243</th>\n","      <td>203997</td>\n","      <td>O sedutor e a escrava abraçados se associavam,...</td>\n","      <td>11</td>\n","      <td>escrava</td>\n","      <td>escravo</td>\n","      <td>As Vítimas-Algozes</td>\n","      <td>Joaquim Manuel de Macedo</td>\n","      <td>1869</td>\n","      <td>2</td>\n","      <td>Romantismo</td>\n","      <td>...</td>\n","      <td>As Vítimas-Algozes</td>\n","      <td>Joaquim Manuel de Macedo</td>\n","      <td>1869</td>\n","      <td>2</td>\n","      <td>Romantismo</td>\n","      <td>Simeão , escravo , contando com a liberdade , ...</td>\n","      <td>55</td>\n","      <td>0.907368</td>\n","      <td>6.427903</td>\n","      <td>162.41837</td>\n","    </tr>\n","    <tr>\n","      <th>1379469</th>\n","      <td>203696</td>\n","      <td>Pois minha senhora acredita, que o senhor Fred...</td>\n","      <td>2</td>\n","      <td>senhora</td>\n","      <td>senhor</td>\n","      <td>As Vítimas-Algozes</td>\n","      <td>Joaquim Manuel de Macedo</td>\n","      <td>1869</td>\n","      <td>2</td>\n","      <td>Romantismo</td>\n","      <td>...</td>\n","      <td>As Vítimas-Algozes</td>\n","      <td>Joaquim Manuel de Macedo</td>\n","      <td>1869</td>\n","      <td>2</td>\n","      <td>Romantismo</td>\n","      <td>Soam os grosseiros instrumentos que lembram as...</td>\n","      <td>66</td>\n","      <td>0.864472</td>\n","      <td>8.125162</td>\n","      <td>202.32175</td>\n","    </tr>\n","    <tr>\n","      <th>404162</th>\n","      <td>200121</td>\n","      <td>Domingos Caetano e Angélica não destinavam Sim...</td>\n","      <td>73</td>\n","      <td>crioulo</td>\n","      <td>crioulo</td>\n","      <td>As Vítimas-Algozes</td>\n","      <td>Joaquim Manuel de Macedo</td>\n","      <td>1869</td>\n","      <td>2</td>\n","      <td>Romantismo</td>\n","      <td>...</td>\n","      <td>As Vítimas-Algozes</td>\n","      <td>Joaquim Manuel de Macedo</td>\n","      <td>1869</td>\n","      <td>2</td>\n","      <td>Romantismo</td>\n","      <td>No Brasil a gente livre mais rude nega , como ...</td>\n","      <td>24</td>\n","      <td>0.905213</td>\n","      <td>6.944480</td>\n","      <td>165.93378</td>\n","    </tr>\n","    <tr>\n","      <th>1162248</th>\n","      <td>200810</td>\n","      <td>O escravo africano mata o senhor, e se afasta ...</td>\n","      <td>14</td>\n","      <td>escravo</td>\n","      <td>escravo</td>\n","      <td>As Vítimas-Algozes</td>\n","      <td>Joaquim Manuel de Macedo</td>\n","      <td>1869</td>\n","      <td>2</td>\n","      <td>Romantismo</td>\n","      <td>...</td>\n","      <td>As Vítimas-Algozes</td>\n","      <td>Joaquim Manuel de Macedo</td>\n","      <td>1869</td>\n","      <td>2</td>\n","      <td>Romantismo</td>\n","      <td>se porém o erro se repete , se o vício ou a co...</td>\n","      <td>56</td>\n","      <td>0.891151</td>\n","      <td>6.813987</td>\n","      <td>171.85657</td>\n","    </tr>\n","    <tr>\n","      <th>1067624</th>\n","      <td>200776</td>\n","      <td>“escravo... escravo...”</td>\n","      <td>3</td>\n","      <td>escravo</td>\n","      <td>escravo</td>\n","      <td>As Vítimas-Algozes</td>\n","      <td>Joaquim Manuel de Macedo</td>\n","      <td>1869</td>\n","      <td>2</td>\n","      <td>Romantismo</td>\n","      <td>...</td>\n","      <td>As Vítimas-Algozes</td>\n","      <td>Joaquim Manuel de Macedo</td>\n","      <td>1869</td>\n","      <td>2</td>\n","      <td>Romantismo</td>\n","      <td>– Que tolice , minha senhora !</td>\n","      <td>7</td>\n","      <td>0.592091</td>\n","      <td>16.336397</td>\n","      <td>399.74260</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5 rows × 27 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-2ebcd70e-f80c-47f1-89ce-4db874880a8d')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-2ebcd70e-f80c-47f1-89ce-4db874880a8d button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-2ebcd70e-f80c-47f1-89ce-4db874880a8d');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":31}],"source":["lista_documentos_originais_filtrados.sample(5)"]},{"cell_type":"code","source":["# Import das bibliotecas.\n","import ast # Biblioteca para conversão de string em lista\n","\n","# Verifica se o tipo da coluna não é list e converte\n","lista_documentos_originais_filtrados[\"cos_mean\"] = lista_documentos_originais_filtrados[\"cos_mean\"].apply(lambda x: float(x) )\n","lista_documentos_originais_filtrados[\"euc_mean\"] = lista_documentos_originais_filtrados[\"euc_mean\"].apply(lambda x: float(x) )\n","lista_documentos_originais_filtrados[\"man_mean\"] = lista_documentos_originais_filtrados[\"man_mean\"].apply(lambda x: float(x) )\n","\n","\n","\n","logging.info(\"TERMINADO CORREÇÃO ORIGINAIS_FILTRADOS: {}.\".format(len(lista_documentos_originais_filtrados)))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"pkXUmrCCKy5X","executionInfo":{"status":"ok","timestamp":1670121068617,"user_tz":180,"elapsed":2719,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"}},"outputId":"b9a30de0-0a54-4d76-bdae-8a9afe57f6eb"},"execution_count":32,"outputs":[{"output_type":"stream","name":"stderr","text":["INFO:root:TERMINADO CORREÇÃO ORIGINAIS_FILTRADOS: 3396616.\n"]}]},{"cell_type":"markdown","metadata":{"id":"kV4ZjkGDWeLl"},"source":["#### filtra as coisas \n"]},{"cell_type":"code","execution_count":33,"metadata":{"executionInfo":{"elapsed":5,"status":"ok","timestamp":1670121068617,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"},"user_tz":180},"id":"TOx5vfZtS4Wm"},"outputs":[],"source":["data = {\n","    0:{\"label\":\"negro\", \"alvo\":[\"negro\",\"negros\",\"negrinho\",\"negrinhos\",\"negra\",\"negras\",\"negrinha\",\"negrinhas\"]},\n","    1:{\"label\":\"crioulo\", \"alvo\": [\"crioulo\",\"crioulos\",\"crioulinho\",\"crioulinhos\",\"crioula\",\"crioulas\",\"crioulinha\",\"crioulinhas\"]},\n","    2:{\"label\":\"mulato\", \"alvo\":[\"mulato\",\"mulatos\",\"mulatinho\",\"mulatinhos\",\"mulata\",\"mulatas\",\"mulatinha\",\"mulatinhas\"]},\n","    3:{\"label\":\"criado\", \"alvo\":[\"criado\",\"criados\",\"criadinho\",\"criadinhos\",\"criada\",\"criadas\",\"criadinha\",\"criadinhas\"]},\n","    4:{\"label\":\"escravo\", \"alvo\":[\"escravo\",\"escravos\",\"escravinho\",\"escravinhos\",\"escrava\",\"escravas\",\"escravinha\",\"escravinhas\"]},\n","    5:{\"label\":\"senhor\", \"alvo\":[\"senhor\",\"senhores\",\"senhora\",\"senhoras\",]},\n","    6:{\"label\":\"branco\", \"alvo\":[\"branco\",\"brancos\",\"branca\",\"brancas\",]},\n","}"]},{"cell_type":"code","execution_count":34,"metadata":{"executionInfo":{"elapsed":4,"status":"ok","timestamp":1670121068617,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"},"user_tz":180},"id":"9JGuFuP5MidR"},"outputs":[],"source":["lista_documentos_filtrados = lista_documentos_originais_filtrados "]},{"cell_type":"code","source":["del lista_documentos_originais_filtrados"],"metadata":{"id":"lbhokWFYvS7L","executionInfo":{"status":"ok","timestamp":1670121068617,"user_tz":180,"elapsed":4,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"}}},"execution_count":35,"outputs":[]},{"cell_type":"code","execution_count":36,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":5,"status":"ok","timestamp":1670121068618,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"},"user_tz":180},"id":"k5pLFDvyNXT7","outputId":"0534382b-6f15-4fc6-a169-8d59799f2822"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["3396616"]},"metadata":{},"execution_count":36}],"source":["len(lista_documentos_filtrados)"]},{"cell_type":"code","source":["lista_documentos_filtrados.sample()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"MW31fRoDMhMO","executionInfo":{"status":"ok","timestamp":1670121069061,"user_tz":180,"elapsed":447,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"}},"outputId":"aae69359-5ccd-4960-a447-f1bd21a384da"},"execution_count":37,"outputs":[{"output_type":"execute_result","data":{"text/plain":["         sw1_id                                      sw1_documento  \\\n","3206601  203670  porque enquanto as flamas do pudor nelas ardia...   \n","\n","         sw1_idOcorrencia sw1_palavraAlvo sw1_grupo            sw1_obra  \\\n","3206601                39         brancos    branco  As Vítimas-Algozes   \n","\n","                        sw1_autor  sw1_ano  sw1_idObra sw1_movimento  ...  \\\n","3206601  Joaquim Manuel de Macedo     1869           2    Romantismo  ...   \n","\n","                   sw2_obra                 sw2_autor  sw2_ano sw2_idObra  \\\n","3206601  As Vítimas-Algozes  Joaquim Manuel de Macedo     1869          2   \n","\n","         sw2_movimento                                       sw2_document  \\\n","3206601     Romantismo  Semelhante ousadia é tão trivial em país onde ...   \n","\n","        sw2_length  cos_mean  euc_mean  man_mean  \n","3206601         17  0.874936  7.734531  191.1947  \n","\n","[1 rows x 27 columns]"],"text/html":["\n","  <div id=\"df-7dadae84-38ed-48eb-9d8d-97a56079fe42\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>sw1_id</th>\n","      <th>sw1_documento</th>\n","      <th>sw1_idOcorrencia</th>\n","      <th>sw1_palavraAlvo</th>\n","      <th>sw1_grupo</th>\n","      <th>sw1_obra</th>\n","      <th>sw1_autor</th>\n","      <th>sw1_ano</th>\n","      <th>sw1_idObra</th>\n","      <th>sw1_movimento</th>\n","      <th>...</th>\n","      <th>sw2_obra</th>\n","      <th>sw2_autor</th>\n","      <th>sw2_ano</th>\n","      <th>sw2_idObra</th>\n","      <th>sw2_movimento</th>\n","      <th>sw2_document</th>\n","      <th>sw2_length</th>\n","      <th>cos_mean</th>\n","      <th>euc_mean</th>\n","      <th>man_mean</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>3206601</th>\n","      <td>203670</td>\n","      <td>porque enquanto as flamas do pudor nelas ardia...</td>\n","      <td>39</td>\n","      <td>brancos</td>\n","      <td>branco</td>\n","      <td>As Vítimas-Algozes</td>\n","      <td>Joaquim Manuel de Macedo</td>\n","      <td>1869</td>\n","      <td>2</td>\n","      <td>Romantismo</td>\n","      <td>...</td>\n","      <td>As Vítimas-Algozes</td>\n","      <td>Joaquim Manuel de Macedo</td>\n","      <td>1869</td>\n","      <td>2</td>\n","      <td>Romantismo</td>\n","      <td>Semelhante ousadia é tão trivial em país onde ...</td>\n","      <td>17</td>\n","      <td>0.874936</td>\n","      <td>7.734531</td>\n","      <td>191.1947</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>1 rows × 27 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-7dadae84-38ed-48eb-9d8d-97a56079fe42')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-7dadae84-38ed-48eb-9d8d-97a56079fe42 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-7dadae84-38ed-48eb-9d8d-97a56079fe42');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":37}]},{"cell_type":"code","source":["lista_documentos_filtrados_describe = lista_documentos_filtrados[[\"cos_mean\",\"euc_mean\",\"man_mean\"]]\n"],"metadata":{"id":"IZh8-KPAOZzS","executionInfo":{"status":"ok","timestamp":1670121069062,"user_tz":180,"elapsed":7,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"}}},"execution_count":38,"outputs":[]},{"cell_type":"code","source":["lista_documentos_filtrados_describe"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"SPSY1Ty0OmZn","executionInfo":{"status":"ok","timestamp":1670121069062,"user_tz":180,"elapsed":6,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"}},"outputId":"bab94d3a-67d5-485a-fc7d-e31b5efe7f71"},"execution_count":39,"outputs":[{"output_type":"execute_result","data":{"text/plain":["         cos_mean  euc_mean   man_mean\n","0        0.920217  5.689066  146.22406\n","1        0.920217  5.689066  146.22406\n","2        0.910345  6.167331  154.95633\n","3        0.910345  6.167331  154.95633\n","4        0.910345  6.167331  154.95633\n","...           ...       ...        ...\n","3396611  0.896694  6.831655  171.34360\n","3396612  0.896694  6.831655  171.34360\n","3396613  0.896694  6.831655  171.34360\n","3396614  0.896694  6.831655  171.34360\n","3396615  0.896694  6.831655  171.34360\n","\n","[3396616 rows x 3 columns]"],"text/html":["\n","  <div id=\"df-da108b8f-6b35-45ff-8d4f-1e3e524760f0\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>cos_mean</th>\n","      <th>euc_mean</th>\n","      <th>man_mean</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0.920217</td>\n","      <td>5.689066</td>\n","      <td>146.22406</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0.920217</td>\n","      <td>5.689066</td>\n","      <td>146.22406</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0.910345</td>\n","      <td>6.167331</td>\n","      <td>154.95633</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0.910345</td>\n","      <td>6.167331</td>\n","      <td>154.95633</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0.910345</td>\n","      <td>6.167331</td>\n","      <td>154.95633</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>3396611</th>\n","      <td>0.896694</td>\n","      <td>6.831655</td>\n","      <td>171.34360</td>\n","    </tr>\n","    <tr>\n","      <th>3396612</th>\n","      <td>0.896694</td>\n","      <td>6.831655</td>\n","      <td>171.34360</td>\n","    </tr>\n","    <tr>\n","      <th>3396613</th>\n","      <td>0.896694</td>\n","      <td>6.831655</td>\n","      <td>171.34360</td>\n","    </tr>\n","    <tr>\n","      <th>3396614</th>\n","      <td>0.896694</td>\n","      <td>6.831655</td>\n","      <td>171.34360</td>\n","    </tr>\n","    <tr>\n","      <th>3396615</th>\n","      <td>0.896694</td>\n","      <td>6.831655</td>\n","      <td>171.34360</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>3396616 rows × 3 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-da108b8f-6b35-45ff-8d4f-1e3e524760f0')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-da108b8f-6b35-45ff-8d4f-1e3e524760f0 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-da108b8f-6b35-45ff-8d4f-1e3e524760f0');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":39}]},{"cell_type":"code","source":["pd.set_option('display.float_format', lambda x: '%.4f' % x)\n","lista_documentos_filtrados_describe.describe()\n","# .apply(\"{0:.5f}\".format)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":300},"id":"St6S868jKWiA","executionInfo":{"status":"ok","timestamp":1670121069492,"user_tz":180,"elapsed":435,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"}},"outputId":"8544beea-1a2b-41bc-ce92-8a88b9a9e7a3"},"execution_count":40,"outputs":[{"output_type":"execute_result","data":{"text/plain":["          cos_mean     euc_mean     man_mean\n","count 3396616.0000 3396616.0000 3396616.0000\n","mean        0.8470       8.5226     212.9505\n","std         0.0560       1.8904      46.6709\n","min         0.4863       0.0000       0.0000\n","25%         0.8129       7.0882     177.5473\n","50%         0.8543       8.3964     210.0354\n","75%         0.8893       9.7990     244.6087\n","max         1.0000      18.7797     466.0917"],"text/html":["\n","  <div id=\"df-ba442875-d269-4a72-9e02-868c6ceac53d\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>cos_mean</th>\n","      <th>euc_mean</th>\n","      <th>man_mean</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>count</th>\n","      <td>3396616.0000</td>\n","      <td>3396616.0000</td>\n","      <td>3396616.0000</td>\n","    </tr>\n","    <tr>\n","      <th>mean</th>\n","      <td>0.8470</td>\n","      <td>8.5226</td>\n","      <td>212.9505</td>\n","    </tr>\n","    <tr>\n","      <th>std</th>\n","      <td>0.0560</td>\n","      <td>1.8904</td>\n","      <td>46.6709</td>\n","    </tr>\n","    <tr>\n","      <th>min</th>\n","      <td>0.4863</td>\n","      <td>0.0000</td>\n","      <td>0.0000</td>\n","    </tr>\n","    <tr>\n","      <th>25%</th>\n","      <td>0.8129</td>\n","      <td>7.0882</td>\n","      <td>177.5473</td>\n","    </tr>\n","    <tr>\n","      <th>50%</th>\n","      <td>0.8543</td>\n","      <td>8.3964</td>\n","      <td>210.0354</td>\n","    </tr>\n","    <tr>\n","      <th>75%</th>\n","      <td>0.8893</td>\n","      <td>9.7990</td>\n","      <td>244.6087</td>\n","    </tr>\n","    <tr>\n","      <th>max</th>\n","      <td>1.0000</td>\n","      <td>18.7797</td>\n","      <td>466.0917</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-ba442875-d269-4a72-9e02-868c6ceac53d')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-ba442875-d269-4a72-9e02-868c6ceac53d button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-ba442875-d269-4a72-9e02-868c6ceac53d');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":40}]},{"cell_type":"code","source":["column_headers = list(lista_documentos_filtrados.columns.values)\n","for value in column_headers:\n","    print(value)\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"qiMIRD6z_NpO","executionInfo":{"status":"ok","timestamp":1670121069493,"user_tz":180,"elapsed":10,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"}},"outputId":"21468a1f-60ca-4902-8815-eaadd7cbf8ac"},"execution_count":41,"outputs":[{"output_type":"stream","name":"stdout","text":["sw1_id\n","sw1_documento\n","sw1_idOcorrencia\n","sw1_palavraAlvo\n","sw1_grupo\n","sw1_obra\n","sw1_autor\n","sw1_ano\n","sw1_idObra\n","sw1_movimento\n","sw1_document\n","sw1_length\n","sw2_id\n","sw2_documento\n","sw2_idOcorrencia\n","sw2_palavraAlvo\n","sw2_grupo\n","sw2_obra\n","sw2_autor\n","sw2_ano\n","sw2_idObra\n","sw2_movimento\n","sw2_document\n","sw2_length\n","cos_mean\n","euc_mean\n","man_mean\n"]}]},{"cell_type":"code","source":["lista_documentos_filtrados['sw1_grupo'].unique()\n","lista_documentos_filtrados = lista_documentos_filtrados.drop_duplicates()\n","\n","# duplicateRows = lista_documentos_filtrados[lista_documentos_filtrados.duplicated()]\n","\n","\n","# print(duplicateRows)"],"metadata":{"id":"Ey5X5p5wBife","executionInfo":{"status":"ok","timestamp":1670121080289,"user_tz":180,"elapsed":10801,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"}}},"execution_count":42,"outputs":[]},{"cell_type":"code","source":["limite = 0.8\n","\n","datas = {\n","    \"negro\":{'ids':[],'cos':[],'euc':[],'man':[],'tamanho':[]},\n","    \"crioulo\":{'ids':[],'cos':[],'euc':[],'man':[],'tamanho':[]},\n","    \"mulato\":{'ids':[],'cos':[],'euc':[],'man':[],'tamanho':[]},\n","    \"criado\":{'ids':[],'cos':[],'euc':[],'man':[],'tamanho':[]},\n","    \"escravo\":{'ids':[],'cos':[],'euc':[],'man':[],'tamanho':[]},\n","    \"senhor\":{'ids':[],'cos':[],'euc':[],'man':[],'tamanho':[]},\n","    \"branco\":{'ids':[],'cos':[],'euc':[],'man':[],'tamanho':[]},\n","}\n","\n","\n","\n","# Barra de progresso dos documentos\n","lista_documentos_originais_bar = tqdm_notebook(lista_documentos_filtrados.iterrows(), desc=f\"Documentos\", unit=f\" documento\", total=len(lista_documentos_filtrados))\n","\n","# Percorre os documentos\n","for i, linha_documento in lista_documentos_originais_bar:  \n","    sw1_id =  linha_documento[\"sw1_id\"]\n","    sw1_documento =  linha_documento[\"sw1_documento\"]\n","    sw1_idOcorrencia =  linha_documento[\"sw1_idOcorrencia\"]\n","    sw1_palavraAlvo =  linha_documento[\"sw1_palavraAlvo\"]\n","    sw1_grupo =  linha_documento[\"sw1_grupo\"]\n","    sw1_obra =  linha_documento[\"sw1_obra\"]\n","    sw1_autor =  linha_documento[\"sw1_autor\"]\n","    sw1_ano =  linha_documento[\"sw1_ano\"]\n","    sw1_idObra =  linha_documento[\"sw1_idObra\"]\n","    sw1_movimento =  linha_documento[\"sw1_movimento\"]\n","    sw1_document =  linha_documento[\"sw1_document\"]\n","    sw1_length =  linha_documento[\"sw1_length\"]\n","    sw2_id =  linha_documento[\"sw2_id\"]\n","    sw2_documento =  linha_documento[\"sw2_documento\"]\n","    sw2_idOcorrencia =  linha_documento[\"sw2_idOcorrencia\"]\n","    sw2_palavraAlvo =  linha_documento[\"sw2_palavraAlvo\"]\n","    sw2_grupo =  linha_documento[\"sw2_grupo\"]\n","    sw2_obra =  linha_documento[\"sw2_obra\"]\n","    sw2_autor =  linha_documento[\"sw2_autor\"]\n","    sw2_ano =  linha_documento[\"sw2_ano\"]\n","    sw2_idObra =  linha_documento[\"sw2_idObra\"]\n","    sw2_movimento =  linha_documento[\"sw2_movimento\"]\n","    sw2_document =  linha_documento[\"sw2_document\"]\n","    sw2_length =  linha_documento[\"sw2_length\"]\n","    cos_mean =  linha_documento[\"cos_mean\"]\n","    euc_mean =  linha_documento[\"euc_mean\"]\n","    man_mean =  linha_documento[\"man_mean\"]\n","\n","    if cos_mean >= limite:\n","        datas[sw1_grupo]['ids'].append([sw1_id])\n","        datas[sw1_grupo]['cos'].append([cos_mean])\n","        datas[sw1_grupo]['euc'].append([euc_mean])\n","        datas[sw1_grupo]['man'].append([man_mean])\n","        datas[sw1_grupo]['tamanho'].append([sw1_length])\n","\n","    \n","\n","\n","\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49,"referenced_widgets":["ca4ebaf6f95f46e29755aba5d8ed1587","f6373b472e53413eb5b3cc4e4ab1939c","4d3c3b26d910424dac60947836b2a773","05a08bfcfa5940b68e86a2cdac4a800d","efea79dc742643d9bbbd951a0f33a99a","84a55640753f43a39c3357b4297fc91a","35187b93166c4e3bbc08e85b8194e3fc","b91f0149f2ca43ada16fcec77c663eb1","60b0ba69155a401891639ee731198519","d78f75bd86154ea7b022e15f12dad5be","76c813af57174d1380cf4ca0ce749849"]},"id":"fj5US0qA_JAM","executionInfo":{"status":"ok","timestamp":1670121540617,"user_tz":180,"elapsed":460334,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"}},"outputId":"bb4cbb6b-9b9d-4767-d82a-d8d808f78482"},"execution_count":43,"outputs":[{"output_type":"display_data","data":{"text/plain":["Documentos:   0%|          | 0/2982878 [00:00<?, ? documento/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"ca4ebaf6f95f46e29755aba5d8ed1587"}},"metadata":{}}]},{"cell_type":"code","source":["import numpy as np\n","\n","if len(datas[\"negro\"]['ids']) != 0:\n","    print(\"negro\", len(datas[\"negro\"]['ids']),\" \",np.median(datas[\"negro\"]['cos']),\" \",np.median(datas[\"negro\"]['euc']),\" \",np.median(datas[\"negro\"]['man']),\" \",np.median(datas[\"negro\"]['tamanho']))\n","\n","if len(datas[\"crioulo\"]['ids']) != 0:\n","    print(\"crioulo\", len(datas[\"crioulo\"]['ids']),\" \",np.median(datas[\"crioulo\"]['cos']),\" \",np.median(datas[\"crioulo\"]['euc']),\" \",np.median(datas[\"crioulo\"]['man']),\" \",np.median(datas[\"crioulo\"]['tamanho']))\n","\n","if len(datas[\"mulato\"]['ids']) != 0:\n","    print(\"mulato\",len(datas[\"mulato\"]['ids']),\" \",np.median(datas[\"mulato\"]['cos']),\" \",np.median(datas[\"mulato\"]['euc']),\" \",np.median(datas[\"mulato\"]['man']),\" \",np.median(datas[\"mulato\"]['tamanho']))\n","\n","if len(datas[\"criado\"]['ids']) != 0:\n","    print(\"criado\", len(datas[\"criado\"]['ids']),\" \",np.median(datas[\"criado\"]['cos']),\" \",np.median(datas[\"criado\"]['euc']),\" \",np.median(datas[\"criado\"]['man']),\" \",np.median(datas[\"criado\"]['tamanho']))\n","\n","if len(datas[\"escravo\"]['ids']) != 0:\n","    print(\"escravo\",len(datas[\"escravo\"]['ids']),\" \",np.median(datas[\"escravo\"]['cos']),\" \",np.median(datas[\"escravo\"]['euc']),\" \",np.median(datas[\"escravo\"]['man']),\" \",np.median(datas[\"escravo\"]['tamanho']))\n","\n","if len(datas[\"senhor\"]['ids']) != 0:\n","    print(\"senhor\",len(datas[\"senhor\"]['ids']),\" \",np.median(datas[\"senhor\"]['cos']),\" \",np.median(datas[\"senhor\"]['euc']),\" \",np.median(datas[\"senhor\"]['man']),\" \",np.median(datas[\"senhor\"]['tamanho']))\n","\n","if len(datas[\"branco\"]['ids']) != 0:\n","    print(\"branco\",len(datas[\"branco\"]['ids']),\" \",np.median(datas[\"branco\"]['cos']),\" \",np.median(datas[\"branco\"]['euc']),\" \",np.median(datas[\"branco\"]['man']),\" \",np.median(datas[\"branco\"]['tamanho']))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"lVJvss9rLbB2","executionInfo":{"status":"ok","timestamp":1670121548377,"user_tz":180,"elapsed":7766,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"}},"outputId":"403c4b7a-1f3e-491d-fbf9-fc47166eba9b"},"execution_count":44,"outputs":[{"output_type":"stream","name":"stdout","text":["negro 258469   0.8652722835540771   7.990420818328857   200.09607   27.0\n","crioulo 316394   0.8675910234451294   7.914159774780273   198.17927   27.0\n","criado 23921   0.8669672012329102   7.898284912109375   198.09995   40.0\n","escravo 904629   0.8737504482269287   7.6567769050598145   191.6872   36.0\n","senhor 875647   0.8642237782478333   8.069803237915039   201.86427   30.0\n","branco 30840   0.8659937381744385   7.950303316116333   198.348975   39.0\n"]}]},{"cell_type":"code","source":["limitador_1 = 0.8\n","lista_documentos_filtrados_limite = lista_documentos_filtrados.loc[lista_documentos_filtrados['cos_mean'] >= limitador_1]\n","\n","lista_documentos_filtrados_limite_negro = lista_documentos_filtrados_limite.loc[lista_documentos_filtrados_limite['sw1_grupo'] == 'negro']\n","lista_documentos_filtrados_limite_crioulo = lista_documentos_filtrados_limite.loc[lista_documentos_filtrados_limite['sw1_grupo'] == 'crioulo']\n","lista_documentos_filtrados_limite_mulato = lista_documentos_filtrados_limite.loc[lista_documentos_filtrados_limite['sw1_grupo'] == 'mulato']\n","lista_documentos_filtrados_limite_criado = lista_documentos_filtrados_limite.loc[lista_documentos_filtrados_limite['sw1_grupo'] == 'criado']\n","lista_documentos_filtrados_limite_escravo = lista_documentos_filtrados_limite.loc[lista_documentos_filtrados_limite['sw1_grupo'] == 'escravo']\n","lista_documentos_filtrados_limite_senhor = lista_documentos_filtrados_limite.loc[lista_documentos_filtrados_limite['sw1_grupo'] == 'senhor']\n","lista_documentos_filtrados_limite_branco = lista_documentos_filtrados_limite.loc[lista_documentos_filtrados_limite['sw1_grupo'] == 'branco']\n"],"metadata":{"id":"v6xnM9pHPwVX","executionInfo":{"status":"ok","timestamp":1670122760362,"user_tz":180,"elapsed":3416,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"}}},"execution_count":72,"outputs":[]},{"cell_type":"code","source":["lista_documentos_filtrados_limite_negro = lista_documentos_filtrados_limite_negro[['sw1_id','sw1_document','sw1_palavraAlvo']]\n","lista_documentos_filtrados_limite_crioulo = lista_documentos_filtrados_limite_crioulo[['sw1_id','sw1_document','sw1_palavraAlvo']]\n","lista_documentos_filtrados_limite_mulato = lista_documentos_filtrados_limite_mulato[['sw1_id','sw1_document','sw1_palavraAlvo']]\n","lista_documentos_filtrados_limite_criado = lista_documentos_filtrados_limite_criado[['sw1_id','sw1_document','sw1_palavraAlvo']]\n","lista_documentos_filtrados_limite_escravo = lista_documentos_filtrados_limite_escravo[['sw1_id','sw1_document','sw1_palavraAlvo']]\n","lista_documentos_filtrados_limite_senhor = lista_documentos_filtrados_limite_senhor[['sw1_id','sw1_document','sw1_palavraAlvo']]\n","lista_documentos_filtrados_limite_branco = lista_documentos_filtrados_limite_branco[['sw1_id','sw1_document','sw1_palavraAlvo']]\n","\n","lista_documentos_filtrados_limite_w = lista_documentos_filtrados_limite[['sw1_id','sw1_document','sw1_palavraAlvo']]\n","\n","lista_documentos_filtrados_limite_negro['contador'] = 0\n","lista_documentos_filtrados_limite_crioulo['contador'] = 0\n","lista_documentos_filtrados_limite_mulato['contador'] = 0\n","lista_documentos_filtrados_limite_criado['contador'] = 0\n","lista_documentos_filtrados_limite_escravo['contador'] = 0\n","lista_documentos_filtrados_limite_senhor['contador'] = 0\n","lista_documentos_filtrados_limite_branco['contador'] = 0\n","lista_documentos_filtrados_limite_w['contador'] = 0"],"metadata":{"id":"LZPZW8MpZD83","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1670122763272,"user_tz":180,"elapsed":661,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"}},"outputId":"7309eeca-e20a-4a93-c97b-cafb8ba1e440"},"execution_count":73,"outputs":[{"output_type":"stream","name":"stderr","text":["<ipython-input-73-16b0e66e0808>:11: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  lista_documentos_filtrados_limite_negro['contador'] = 0\n","<ipython-input-73-16b0e66e0808>:12: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  lista_documentos_filtrados_limite_crioulo['contador'] = 0\n","<ipython-input-73-16b0e66e0808>:14: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  lista_documentos_filtrados_limite_criado['contador'] = 0\n","<ipython-input-73-16b0e66e0808>:15: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  lista_documentos_filtrados_limite_escravo['contador'] = 0\n","<ipython-input-73-16b0e66e0808>:16: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  lista_documentos_filtrados_limite_senhor['contador'] = 0\n","<ipython-input-73-16b0e66e0808>:17: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  lista_documentos_filtrados_limite_branco['contador'] = 0\n","<ipython-input-73-16b0e66e0808>:18: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  lista_documentos_filtrados_limite_w['contador'] = 0\n"]}]},{"cell_type":"code","source":["lista_documentos_filtrados_limite_negro_group = lista_documentos_filtrados_limite_negro.groupby(['sw1_id','sw1_document','sw1_palavraAlvo'],sort=False).count()\n","lista_documentos_filtrados_limite_negro_sorted = lista_documentos_filtrados_limite_negro_group.sort_values('contador', ascending=False)['contador']\n","len(lista_documentos_filtrados_limite_negro_sorted)"],"metadata":{"id":"9sfP_kkXZbQj","executionInfo":{"status":"ok","timestamp":1670122541210,"user_tz":180,"elapsed":405,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"20dda066-db64-44ac-f978-1a96ac7b21af"},"execution_count":67,"outputs":[{"output_type":"execute_result","data":{"text/plain":["186"]},"metadata":{},"execution_count":67}]},{"cell_type":"code","source":["lista_documentos_filtrados_limite_w_duplicates = lista_documentos_filtrados_limite_w.drop_duplicates()\n","\n","lista_documentos_filtrados_limite_w_duplicates_group = lista_documentos_filtrados_limite_w_duplicates.groupby(['sw1_id','sw1_document'],sort=False).count()\n","lista_documentos_filtrados_limite_w_duplicates_sorted = lista_documentos_filtrados_limite_w_duplicates_group.sort_values('contador', ascending=False)['contador']\n","len(lista_documentos_filtrados_limite_w_duplicates_sorted)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"I2EnSJkxEauy","executionInfo":{"status":"ok","timestamp":1670122819434,"user_tz":180,"elapsed":1251,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"}},"outputId":"dfdafe34-0642-4407-a8c6-f21d8ecf46c6"},"execution_count":74,"outputs":[{"output_type":"execute_result","data":{"text/plain":["1249"]},"metadata":{},"execution_count":74}]},{"cell_type":"code","source":["print(lista_documentos_filtrados_limite_w_duplicates_sorted[0:10])"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"x0xqipUJhls3","executionInfo":{"status":"ok","timestamp":1670122854307,"user_tz":180,"elapsed":7,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"}},"outputId":"85b4cb6a-e3ac-488c-a557-1479ad64879a"},"execution_count":76,"outputs":[{"output_type":"stream","name":"stdout","text":["sw1_id  sw1_document                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \n","201540  Haveria sim , mas não seria escrava amante de seu senhor , não seria a inimiga natural dos senhores elevada a rival da senhora , não seria esta a dilacerar-se em seu nobre orgulho esmagado ao ver a negra , sua escrava , usurpando-lhe amor , autoridade , direito , ao ver seus filhinhos expostos e sujeitos à influência maléfica , odienta , terrível da própria escrava deles , mulher inimiga pelos ressentimentos de sua condição , perversa e corrompida pelos costumes ; ao ver a fortuna da família ameaçada pela escrava-rainha , sacerdotisa dos vícios imundos , estragadora da fazenda pelos desatinos do fazendeiro , pela conseqüente arrogância e desnorteamento dos escravos que escarnecem e aplaudem , aborrecem e exploram a elevação da parceira , e desrespeitam , apodam    6\n","203546  Eis aí pois , pensava ele , uma escrava perversa e devassa como todas as escravas mais ou menos o são , comprometendo o nome e a reputação de uma donzela , sua senhora , para atrair um homem branco e satisfazer seu vício escandaloso ; o pajem que levou o recado a Souvanel , convidando-o para a entrevista noturna , sem dúvida imagina sua senhora-moça nos braços do sedutor , e irá murmurar do seu opróbrio , conversando com os parceiros , prontos como ele a acreditar na infâmia que pode manchar os senhores .                                                                                                                                                                                                                                                                         5\n","200101  No amor dos senhores o crioulo estimado viu , sentiu , gozou os reflexos das flamas vivificantes , generosas , sagradas da liberdade : mas vem um dia em que ele se reconhece escravo , coisa e não homem , apesar da afeição , das condescendências , dos caridosos benefícios do senhor – amigo , da senhora – segunda mãe ; vem a primeira hora sinistra em que ele , que até então vivera em sonhos e ilusões , desperta com a certeza horrível de que é um condenado daquém-berço ; condenado sem crime ;                                                                                                                                                                                                                                                                                         5\n","200100  Fora absurdo pretender que a ingratidão às vezes até profundamente perversa dos crioulos amorosamente criados por seus senhores é neles inata ou condição natural da sua raça : a fonte do mal , que é mais negra do que a cor desses infelizes , é a escravidão , a consciência desse estado violenta e barbaramente imposto , estado lúgubre , revoltante , condição ignóbil , mãe do ódio , pústula encerradora de raiva , pantanal dos vícios mais torpes que degeneram , infeccionam , e tornam perverso o coração da vítima , o coração do escravo .                                                                                                                                                                                                                                             5\n","201694  – Sou negra escrava lançada no campo : animal solto e livre , se eu me desforrasse do desprezo em que meu senhor me abandona , abrindo a porta da minha senzala aos negros meus parceiros e do meu gosto , faria muito bem .                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           4\n","204476  Os brancos lábios da senhora tocaram o ouvido negro da escrava e murmuraram :                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          4\n","205609  Alguns dias depois os noivos e seus pais preparavam-se para voltar a seu lares , quando um agente policial , ou interesseiro procurador se apresentou na casa de Florêncio da Silva , anunciando que se achavam detidos e presos na casa de correção , um pajem , e uma negra crioula que se confessavam escravos , dando o nome de Florêncio , como o de seu senhor .                                                                                                                                                                                                                                                                                                                                                                                                                                 4\n","201810  A escrava tornada senhora do desprezível senhor exasperava-se por continuar escrava do escravo mais hediondo ; ela , porém , não ousava arrostar Pai-Raiol o feiticeiro , o rei das serpentes , o demônio que matava de longe com os olhos : poderia facilmente conseguir que Paulo Borges mandasse vender em outro município ou em outra província o seu detestável sócio ; já tinha pensado nesse recurso ;                                                                                                                                                                                                                                                                                                                                                                                          4\n","201462  E o grande perigo não está no fato do adultério , que aliás de parte a parte é sempre igualmente condenável : o grande perigo está na condição da mulher , em quem se realiza o adultério ; está na condição da escrava que , tendo feito dessa mulher inimiga natural , inimiga lógica e indeclinável de seus senhores e especialmente de sua senhora , aproveita para a vingança , para as maldades , cujo limite ninguém pode marcar , o crime do senhor que infamemente a erige em rival de sua senhora , pelo só escândalo do adultério insistente com rival preferida .                                                                                                                                                                                                                          4\n","202216  XXVI É de regra que a negra que foi escrava e se tornou senhora , seja a pior das senhoras :                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           4\n","Name: contador, dtype: int64\n"]}]},{"cell_type":"code","source":["lista_documentos_filtrados_limite"],"metadata":{"id":"2rMJOerUmDmE","colab":{"base_uri":"https://localhost:8080/","height":988},"executionInfo":{"status":"ok","timestamp":1670121553416,"user_tz":180,"elapsed":1921,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"}},"outputId":"76aede89-4b51-4649-d73f-14b0b6b5cb03"},"execution_count":49,"outputs":[{"output_type":"execute_result","data":{"text/plain":["         sw1_id                                      sw1_documento  \\\n","0        200016  Explorador das trevas protetoras dos vícios e ...   \n","1        200018  vêm os quilombolas escravos fugidos e acoitado...   \n","2        200016  Explorador das trevas protetoras dos vícios e ...   \n","3        200019  E o vendelhão é em regra a vigilância protetor...   \n","4        200016  Explorador das trevas protetoras dos vícios e ...   \n","...         ...                                                ...   \n","3396611  205630  E depois com esses escravos ao pé de vós, em t...   \n","3396612  205629  Em face de que Deus vos direis senhores de hom...   \n","3396613  205630  E depois com esses escravos ao pé de vós, em t...   \n","3396614  205629  Em face de que Deus vos direis senhores de hom...   \n","3396615  205630  E depois com esses escravos ao pé de vós, em t...   \n","\n","         sw1_idOcorrencia sw1_palavraAlvo sw1_grupo            sw1_obra  \\\n","0                      49        escravos   escravo  As Vítimas-Algozes   \n","1                       3        escravos   escravo  As Vítimas-Algozes   \n","2                      49        escravos   escravo  As Vítimas-Algozes   \n","3                      32        escravos   escravo  As Vítimas-Algozes   \n","4                      49        escravos   escravo  As Vítimas-Algozes   \n","...                   ...             ...       ...                 ...   \n","3396611                67        escravos   escravo  As Vítimas-Algozes   \n","3396612                24        senhores    senhor  As Vítimas-Algozes   \n","3396613                 4        escravos   escravo  As Vítimas-Algozes   \n","3396614                24        senhores    senhor  As Vítimas-Algozes   \n","3396615                67        escravos   escravo  As Vítimas-Algozes   \n","\n","                        sw1_autor  sw1_ano  sw1_idObra sw1_movimento  ...  \\\n","0        Joaquim Manuel de Macedo     1869           2    Romantismo  ...   \n","1        Joaquim Manuel de Macedo     1869           2    Romantismo  ...   \n","2        Joaquim Manuel de Macedo     1869           2    Romantismo  ...   \n","3        Joaquim Manuel de Macedo     1869           2    Romantismo  ...   \n","4        Joaquim Manuel de Macedo     1869           2    Romantismo  ...   \n","...                           ...      ...         ...           ...  ...   \n","3396611  Joaquim Manuel de Macedo     1869           2    Romantismo  ...   \n","3396612  Joaquim Manuel de Macedo     1869           2    Romantismo  ...   \n","3396613  Joaquim Manuel de Macedo     1869           2    Romantismo  ...   \n","3396614  Joaquim Manuel de Macedo     1869           2    Romantismo  ...   \n","3396615  Joaquim Manuel de Macedo     1869           2    Romantismo  ...   \n","\n","                   sw2_obra                 sw2_autor  sw2_ano sw2_idObra  \\\n","0        As Vítimas-Algozes  Joaquim Manuel de Macedo     1869          2   \n","1        As Vítimas-Algozes  Joaquim Manuel de Macedo     1869          2   \n","2        As Vítimas-Algozes  Joaquim Manuel de Macedo     1869          2   \n","3        As Vítimas-Algozes  Joaquim Manuel de Macedo     1869          2   \n","4        As Vítimas-Algozes  Joaquim Manuel de Macedo     1869          2   \n","...                     ...                       ...      ...        ...   \n","3396611  As Vítimas-Algozes  Joaquim Manuel de Macedo     1869          2   \n","3396612  As Vítimas-Algozes  Joaquim Manuel de Macedo     1869          2   \n","3396613  As Vítimas-Algozes  Joaquim Manuel de Macedo     1869          2   \n","3396614  As Vítimas-Algozes  Joaquim Manuel de Macedo     1869          2   \n","3396615  As Vítimas-Algozes  Joaquim Manuel de Macedo     1869          2   \n","\n","         sw2_movimento                                       sw2_document  \\\n","0           Romantismo  vêm os quilombolas escravos fugidos e acoitado...   \n","1           Romantismo  Explorador das trevas protetoras dos vícios e ...   \n","2           Romantismo  E o vendelhão é em regra a vigilância protetor...   \n","3           Romantismo  Explorador das trevas protetoras dos vícios e ...   \n","4           Romantismo  E o vendelhão é em regra a vigilância protetor...   \n","...                ...                                                ...   \n","3396611     Romantismo  Em face de que Deus vos direis senhores de hom...   \n","3396612     Romantismo  E depois com esses escravos ao pé de vós , em ...   \n","3396613     Romantismo  Em face de que Deus vos direis senhores de hom...   \n","3396614     Romantismo  E depois com esses escravos ao pé de vós , em ...   \n","3396615     Romantismo  Em face de que Deus vos direis senhores de hom...   \n","\n","        sw2_length cos_mean euc_mean  man_mean  \n","0               71   0.9202   5.6891  146.2241  \n","1               79   0.9202   5.6891  146.2241  \n","2               35   0.9103   6.1673  154.9563  \n","3               79   0.9103   6.1673  154.9563  \n","4               35   0.9103   6.1673  154.9563  \n","...            ...      ...      ...       ...  \n","3396611         29   0.8967   6.8317  171.3436  \n","3396612         79   0.8967   6.8317  171.3436  \n","3396613         29   0.8967   6.8317  171.3436  \n","3396614         79   0.8967   6.8317  171.3436  \n","3396615         29   0.8967   6.8317  171.3436  \n","\n","[2409900 rows x 27 columns]"],"text/html":["\n","  <div id=\"df-2750b458-1d44-461a-adca-b6a771b1dee2\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>sw1_id</th>\n","      <th>sw1_documento</th>\n","      <th>sw1_idOcorrencia</th>\n","      <th>sw1_palavraAlvo</th>\n","      <th>sw1_grupo</th>\n","      <th>sw1_obra</th>\n","      <th>sw1_autor</th>\n","      <th>sw1_ano</th>\n","      <th>sw1_idObra</th>\n","      <th>sw1_movimento</th>\n","      <th>...</th>\n","      <th>sw2_obra</th>\n","      <th>sw2_autor</th>\n","      <th>sw2_ano</th>\n","      <th>sw2_idObra</th>\n","      <th>sw2_movimento</th>\n","      <th>sw2_document</th>\n","      <th>sw2_length</th>\n","      <th>cos_mean</th>\n","      <th>euc_mean</th>\n","      <th>man_mean</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>200016</td>\n","      <td>Explorador das trevas protetoras dos vícios e ...</td>\n","      <td>49</td>\n","      <td>escravos</td>\n","      <td>escravo</td>\n","      <td>As Vítimas-Algozes</td>\n","      <td>Joaquim Manuel de Macedo</td>\n","      <td>1869</td>\n","      <td>2</td>\n","      <td>Romantismo</td>\n","      <td>...</td>\n","      <td>As Vítimas-Algozes</td>\n","      <td>Joaquim Manuel de Macedo</td>\n","      <td>1869</td>\n","      <td>2</td>\n","      <td>Romantismo</td>\n","      <td>vêm os quilombolas escravos fugidos e acoitado...</td>\n","      <td>71</td>\n","      <td>0.9202</td>\n","      <td>5.6891</td>\n","      <td>146.2241</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>200018</td>\n","      <td>vêm os quilombolas escravos fugidos e acoitado...</td>\n","      <td>3</td>\n","      <td>escravos</td>\n","      <td>escravo</td>\n","      <td>As Vítimas-Algozes</td>\n","      <td>Joaquim Manuel de Macedo</td>\n","      <td>1869</td>\n","      <td>2</td>\n","      <td>Romantismo</td>\n","      <td>...</td>\n","      <td>As Vítimas-Algozes</td>\n","      <td>Joaquim Manuel de Macedo</td>\n","      <td>1869</td>\n","      <td>2</td>\n","      <td>Romantismo</td>\n","      <td>Explorador das trevas protetoras dos vícios e ...</td>\n","      <td>79</td>\n","      <td>0.9202</td>\n","      <td>5.6891</td>\n","      <td>146.2241</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>200016</td>\n","      <td>Explorador das trevas protetoras dos vícios e ...</td>\n","      <td>49</td>\n","      <td>escravos</td>\n","      <td>escravo</td>\n","      <td>As Vítimas-Algozes</td>\n","      <td>Joaquim Manuel de Macedo</td>\n","      <td>1869</td>\n","      <td>2</td>\n","      <td>Romantismo</td>\n","      <td>...</td>\n","      <td>As Vítimas-Algozes</td>\n","      <td>Joaquim Manuel de Macedo</td>\n","      <td>1869</td>\n","      <td>2</td>\n","      <td>Romantismo</td>\n","      <td>E o vendelhão é em regra a vigilância protetor...</td>\n","      <td>35</td>\n","      <td>0.9103</td>\n","      <td>6.1673</td>\n","      <td>154.9563</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>200019</td>\n","      <td>E o vendelhão é em regra a vigilância protetor...</td>\n","      <td>32</td>\n","      <td>escravos</td>\n","      <td>escravo</td>\n","      <td>As Vítimas-Algozes</td>\n","      <td>Joaquim Manuel de Macedo</td>\n","      <td>1869</td>\n","      <td>2</td>\n","      <td>Romantismo</td>\n","      <td>...</td>\n","      <td>As Vítimas-Algozes</td>\n","      <td>Joaquim Manuel de Macedo</td>\n","      <td>1869</td>\n","      <td>2</td>\n","      <td>Romantismo</td>\n","      <td>Explorador das trevas protetoras dos vícios e ...</td>\n","      <td>79</td>\n","      <td>0.9103</td>\n","      <td>6.1673</td>\n","      <td>154.9563</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>200016</td>\n","      <td>Explorador das trevas protetoras dos vícios e ...</td>\n","      <td>49</td>\n","      <td>escravos</td>\n","      <td>escravo</td>\n","      <td>As Vítimas-Algozes</td>\n","      <td>Joaquim Manuel de Macedo</td>\n","      <td>1869</td>\n","      <td>2</td>\n","      <td>Romantismo</td>\n","      <td>...</td>\n","      <td>As Vítimas-Algozes</td>\n","      <td>Joaquim Manuel de Macedo</td>\n","      <td>1869</td>\n","      <td>2</td>\n","      <td>Romantismo</td>\n","      <td>E o vendelhão é em regra a vigilância protetor...</td>\n","      <td>35</td>\n","      <td>0.9103</td>\n","      <td>6.1673</td>\n","      <td>154.9563</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>3396611</th>\n","      <td>205630</td>\n","      <td>E depois com esses escravos ao pé de vós, em t...</td>\n","      <td>67</td>\n","      <td>escravos</td>\n","      <td>escravo</td>\n","      <td>As Vítimas-Algozes</td>\n","      <td>Joaquim Manuel de Macedo</td>\n","      <td>1869</td>\n","      <td>2</td>\n","      <td>Romantismo</td>\n","      <td>...</td>\n","      <td>As Vítimas-Algozes</td>\n","      <td>Joaquim Manuel de Macedo</td>\n","      <td>1869</td>\n","      <td>2</td>\n","      <td>Romantismo</td>\n","      <td>Em face de que Deus vos direis senhores de hom...</td>\n","      <td>29</td>\n","      <td>0.8967</td>\n","      <td>6.8317</td>\n","      <td>171.3436</td>\n","    </tr>\n","    <tr>\n","      <th>3396612</th>\n","      <td>205629</td>\n","      <td>Em face de que Deus vos direis senhores de hom...</td>\n","      <td>24</td>\n","      <td>senhores</td>\n","      <td>senhor</td>\n","      <td>As Vítimas-Algozes</td>\n","      <td>Joaquim Manuel de Macedo</td>\n","      <td>1869</td>\n","      <td>2</td>\n","      <td>Romantismo</td>\n","      <td>...</td>\n","      <td>As Vítimas-Algozes</td>\n","      <td>Joaquim Manuel de Macedo</td>\n","      <td>1869</td>\n","      <td>2</td>\n","      <td>Romantismo</td>\n","      <td>E depois com esses escravos ao pé de vós , em ...</td>\n","      <td>79</td>\n","      <td>0.8967</td>\n","      <td>6.8317</td>\n","      <td>171.3436</td>\n","    </tr>\n","    <tr>\n","      <th>3396613</th>\n","      <td>205630</td>\n","      <td>E depois com esses escravos ao pé de vós, em t...</td>\n","      <td>4</td>\n","      <td>escravos</td>\n","      <td>escravo</td>\n","      <td>As Vítimas-Algozes</td>\n","      <td>Joaquim Manuel de Macedo</td>\n","      <td>1869</td>\n","      <td>2</td>\n","      <td>Romantismo</td>\n","      <td>...</td>\n","      <td>As Vítimas-Algozes</td>\n","      <td>Joaquim Manuel de Macedo</td>\n","      <td>1869</td>\n","      <td>2</td>\n","      <td>Romantismo</td>\n","      <td>Em face de que Deus vos direis senhores de hom...</td>\n","      <td>29</td>\n","      <td>0.8967</td>\n","      <td>6.8317</td>\n","      <td>171.3436</td>\n","    </tr>\n","    <tr>\n","      <th>3396614</th>\n","      <td>205629</td>\n","      <td>Em face de que Deus vos direis senhores de hom...</td>\n","      <td>24</td>\n","      <td>senhores</td>\n","      <td>senhor</td>\n","      <td>As Vítimas-Algozes</td>\n","      <td>Joaquim Manuel de Macedo</td>\n","      <td>1869</td>\n","      <td>2</td>\n","      <td>Romantismo</td>\n","      <td>...</td>\n","      <td>As Vítimas-Algozes</td>\n","      <td>Joaquim Manuel de Macedo</td>\n","      <td>1869</td>\n","      <td>2</td>\n","      <td>Romantismo</td>\n","      <td>E depois com esses escravos ao pé de vós , em ...</td>\n","      <td>79</td>\n","      <td>0.8967</td>\n","      <td>6.8317</td>\n","      <td>171.3436</td>\n","    </tr>\n","    <tr>\n","      <th>3396615</th>\n","      <td>205630</td>\n","      <td>E depois com esses escravos ao pé de vós, em t...</td>\n","      <td>67</td>\n","      <td>escravos</td>\n","      <td>escravo</td>\n","      <td>As Vítimas-Algozes</td>\n","      <td>Joaquim Manuel de Macedo</td>\n","      <td>1869</td>\n","      <td>2</td>\n","      <td>Romantismo</td>\n","      <td>...</td>\n","      <td>As Vítimas-Algozes</td>\n","      <td>Joaquim Manuel de Macedo</td>\n","      <td>1869</td>\n","      <td>2</td>\n","      <td>Romantismo</td>\n","      <td>Em face de que Deus vos direis senhores de hom...</td>\n","      <td>29</td>\n","      <td>0.8967</td>\n","      <td>6.8317</td>\n","      <td>171.3436</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>2409900 rows × 27 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-2750b458-1d44-461a-adca-b6a771b1dee2')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-2750b458-1d44-461a-adca-b6a771b1dee2 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-2750b458-1d44-461a-adca-b6a771b1dee2');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":49}]},{"cell_type":"code","source":["lista_documentos_filtrados_limite_negro_sw1_sw2 = lista_documentos_filtrados_limite.loc[(lista_documentos_filtrados_limite['sw1_grupo'] == 'negro') & (lista_documentos_filtrados_limite['sw1_id'] == 200918)]"],"metadata":{"id":"KkYF6MYZlm8d","executionInfo":{"status":"ok","timestamp":1670121553417,"user_tz":180,"elapsed":13,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"}}},"execution_count":50,"outputs":[]},{"cell_type":"code","source":["lista_documentos_filtrados_limite_negro_sw1_sw2 = lista_documentos_filtrados_limite_negro_sw1_sw2.sort_values('cos_mean', ascending=False)"],"metadata":{"id":"ltLMFQoimZ7E","executionInfo":{"status":"ok","timestamp":1670121553417,"user_tz":180,"elapsed":12,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"}}},"execution_count":51,"outputs":[]},{"cell_type":"code","source":["lista_documentos_filtrados_limite_negro_sw1_sw2.head(2)[['sw1_id','sw2_palavraAlvo','sw2_grupo','sw2_document']]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":112},"id":"O-ED-uJgnKgf","executionInfo":{"status":"ok","timestamp":1670121553417,"user_tz":180,"elapsed":11,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"}},"outputId":"8cd2b2b2-f4f9-4c48-f3c5-d93538e44d3d"},"execution_count":52,"outputs":[{"output_type":"execute_result","data":{"text/plain":["         sw1_id sw2_palavraAlvo sw2_grupo  \\\n","1282422  200918         senhora    senhor   \n","1279514  200918           negro     negro   \n","\n","                                              sw2_document  \n","1282422  Simeão , esquecendo o golpe que recebera , e o...  \n","1279514  Simeão , esquecendo o golpe que recebera , e o...  "],"text/html":["\n","  <div id=\"df-8784b9de-ce7a-4a43-8394-106950da38dc\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>sw1_id</th>\n","      <th>sw2_palavraAlvo</th>\n","      <th>sw2_grupo</th>\n","      <th>sw2_document</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>1282422</th>\n","      <td>200918</td>\n","      <td>senhora</td>\n","      <td>senhor</td>\n","      <td>Simeão , esquecendo o golpe que recebera , e o...</td>\n","    </tr>\n","    <tr>\n","      <th>1279514</th>\n","      <td>200918</td>\n","      <td>negro</td>\n","      <td>negro</td>\n","      <td>Simeão , esquecendo o golpe que recebera , e o...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-8784b9de-ce7a-4a43-8394-106950da38dc')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-8784b9de-ce7a-4a43-8394-106950da38dc button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-8784b9de-ce7a-4a43-8394-106950da38dc');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":52}]},{"cell_type":"code","source":[],"metadata":{"id":"gi0wcFFpfVpz","executionInfo":{"status":"ok","timestamp":1670121553418,"user_tz":180,"elapsed":10,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"}}},"execution_count":52,"outputs":[]},{"cell_type":"code","source":["len(lista_documentos_filtrados_limite)"],"metadata":{"id":"rsMGpSYoX_z2","executionInfo":{"status":"ok","timestamp":1670121553722,"user_tz":180,"elapsed":313,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"d8010a9d-2ef1-48b9-df29-fb6bbe6f04eb"},"execution_count":53,"outputs":[{"output_type":"execute_result","data":{"text/plain":["2409900"]},"metadata":{},"execution_count":53}]},{"cell_type":"markdown","metadata":{"id":"Yj0ya60zrm8t"},"source":["# 4 Finalização"]},{"cell_type":"markdown","metadata":{"id":"Bcjt085lZGUr"},"source":["## 4.1 Tempo final de processamento\n","\n"]},{"cell_type":"code","execution_count":54,"metadata":{"id":"H50_GKJwpDha","executionInfo":{"status":"ok","timestamp":1670121553723,"user_tz":180,"elapsed":14,"user":{"displayName":"Leandro Dias","userId":"15287680885186282361"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"9d3321df-bab3-43d8-8771-98fb24765aed"},"outputs":[{"output_type":"stream","name":"stdout","text":["\n","  Tempo processamento:  0:10:15 (h:mm:ss)\n"]}],"source":["# Pega o tempo atual menos o tempo do início do processamento.\n","final_processamento = time.time()\n","tempo_total_processamento = formataTempo(final_processamento - inicio_processamento)\n","\n","print(\"\")\n","print(\"  Tempo processamento:  {:} (h:mm:ss)\".format(tempo_total_processamento))"]}],"metadata":{"colab":{"collapsed_sections":["EKOTlwcmxmej","PKUr9Vk4BNLC","GOcN8hK-scnt","iAPVtRXQqDim","_GjYtXcMnSAe","Pqa-7WXBAw8q","SUxlx7Sx4yxj","L7G3-MOsQ1N_","AEzytjZi5Iw2","onM1ZApom-_W","6ZVwbmn3Nx2t","Jxe-mh-l6sJY","m4KV_jI-Nx2w","bGaf7bkpAEiX","ZB6bR42PA28c","B4Soqt3fp3Lu","ENvsIER06sJX","b01WgMSSKY_u","TouR4GjNJZD6","_xaeX0oTVQ5t","MBGTMy8Ic7GK","uiuxdXe9t1BX","rHt4e5pAcEMd","V74WUpHqcfoI","eaneOhAKcO-3","6tKcaIfReqdy","e8n7Z5s-QZF8","-pZZrUKRhR3e","-uFDhRTZe2Js","d7KprWqyZBQZ","lCJzsw8T0I-5","s42mgtmSZ8MR","q7nx_eZ8hSlr","-rLcMuDHC-F5","zFd1rse11DpZ","3wvgXwN81RCz","kGL37G6XFcwp","L_vknrk7YSpF","JplTToZvDLiX","xKaqQPs8VQ5u","fazAuLMUr_c0","S6A6-Xwg8GJw","Usr1uRzQeJSb","Yj0ya60zrm8t","Bcjt085lZGUr"],"provenance":[{"file_id":"1q3JTcgbWA46Zih94jwddt39KFLhyntww","timestamp":1663731761602},{"file_id":"1MGqfSbWIJImPFuCcPnfbG9-XJNkYsAoP","timestamp":1663257809933},{"file_id":"1fa1ZrVSmNY6tEau6KIW0M3PxcITiS9cs","timestamp":1663065419767},{"file_id":"1ZQvuAVwA3IjybezQOXnrXMGAnMyZRuPU","timestamp":1585340447636},{"file_id":"1FsBCkREOaDopLF3PIYUuQxLR8wRfjQY1","timestamp":1559844903389},{"file_id":"1f_snPs--PVYgZJwT3GwjxqVALFJ0T2-y","timestamp":1554843110227}],"toc_visible":true},"kernelspec":{"display_name":"Python 3","name":"python3"},"widgets":{"application/vnd.jupyter.widget-state+json":{"ca4ebaf6f95f46e29755aba5d8ed1587":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_f6373b472e53413eb5b3cc4e4ab1939c","IPY_MODEL_4d3c3b26d910424dac60947836b2a773","IPY_MODEL_05a08bfcfa5940b68e86a2cdac4a800d"],"layout":"IPY_MODEL_efea79dc742643d9bbbd951a0f33a99a"}},"f6373b472e53413eb5b3cc4e4ab1939c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_84a55640753f43a39c3357b4297fc91a","placeholder":"​","style":"IPY_MODEL_35187b93166c4e3bbc08e85b8194e3fc","value":"Documentos: 100%"}},"4d3c3b26d910424dac60947836b2a773":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_b91f0149f2ca43ada16fcec77c663eb1","max":2982878,"min":0,"orientation":"horizontal","style":"IPY_MODEL_60b0ba69155a401891639ee731198519","value":2982878}},"05a08bfcfa5940b68e86a2cdac4a800d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d78f75bd86154ea7b022e15f12dad5be","placeholder":"​","style":"IPY_MODEL_76c813af57174d1380cf4ca0ce749849","value":" 2982878/2982878 [07:40&lt;00:00, 6871.55 documento/s]"}},"efea79dc742643d9bbbd951a0f33a99a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"84a55640753f43a39c3357b4297fc91a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"35187b93166c4e3bbc08e85b8194e3fc":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b91f0149f2ca43ada16fcec77c663eb1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"60b0ba69155a401891639ee731198519":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"d78f75bd86154ea7b022e15f12dad5be":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"76c813af57174d1380cf4ca0ce749849":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"nbformat":4,"nbformat_minor":0}